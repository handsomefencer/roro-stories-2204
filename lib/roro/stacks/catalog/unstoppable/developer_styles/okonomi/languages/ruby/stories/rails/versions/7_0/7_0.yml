preface: some string

env:

  base:
    rails_version:
      name: Ruby on Rails minor version
      value: 7.0.0.alpha2
    app_name:
      name: Name for your app
      value: unstoppable_app

actions:
  - directory 'stage_one', '.', @env
  - run 'sudo DOCKER_BUILDKIT=1 docker build --file Dockerfile --output . .'
  - run 'sudo chown -R $USER:$USER .'
  - directory 'stage_two', '.', @env
  - chmod 'entrypoints/docker-entrypoint.sh', 0755
  - chmod 'entrypoints/sidekiq-entrypoint.sh', 0755
  - insert_into_file 'Gemfile', "gem 'sidekiq', '~>6.0.0'", :before => "group :development, :test do"
  - run "sudo docker-compose build"
  - run "sudo chown -R $USER:$USER ."
  - run "sudo docker-compose run web rake db:create"
  - run "sudo docker-compose up -d"


