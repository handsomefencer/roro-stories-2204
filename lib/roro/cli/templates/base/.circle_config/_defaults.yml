defaults: &defaults
  executor: machine-executor
  working_directory: ~/project
 
version: 2.1

executors:
  machine-executor: 
    machine:
      docker_layer_caching: true
  ruby-executor: 
    docker:
      - image: cimg/ruby:2.7

setup_workspace: &setup_workspace
  - checkout
  - attach_workspace:
      at: /tmp/workspace
  - run: |
      cp -rf /tmp/workspace/roro .
      echo 'source roro/containers/app/ci.env' >> $BASH_ENV
      source $BASH_ENV
